{"ast":null,"code":"import _slicedToArray from\"/Users/parth/Desktop/web-dev/social-media-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect,Fragment}from\"react\";import classes from\"./Feed.module.css\";import{Post_Delete_Btn}from\"../../ui/button/Button\";import{UserContext}from\"../../context/userContext\";import Post from\"./post/Post\";import{db,timestamp,storage}from\"../../firebase/firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Feed=function Feed(){var _useContext$user=_slicedToArray(useContext(UserContext).user,1),user=_useContext$user[0];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];useEffect(function(){db.collection(\"posts\").orderBy(\"timestamp\",\"desc\").onSnapshot(function(snapshot){setPosts(snapshot.docs.map(function(doc){return{id:doc.id,post:doc.data()};}));});},[]);var _onDeleteHandler=function onDeleteHandler(id,post){//targeting\nvar imageRef=storage.refFromURL(post.photoUrl);//deleting the image\nimageRef.delete().then(function(){return console.log(\"Deleted successfully\");}).catch(function(error){return console.log(error.message);});//deleting the post\ndb.collection(\"posts\").doc(id).delete().then(function(){return console.log(\"Deleted successfully\");}).catch(function(error){return console.log(error.message);});};return/*#__PURE__*/_jsx(Fragment,{children:posts.map(function(_ref){var id=_ref.id,post=_ref.post;return/*#__PURE__*/_jsxs(\"div\",{className:classes.feed,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.feed_container,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.feed_left_side,children:[/*#__PURE__*/_jsx(\"img\",{src:post.profileUrl,alt:\"profile_pic\",className:classes.feed_img},Math.random()),/*#__PURE__*/_jsx(\"p\",{className:classes.feed_username,children:post.username},Math.random())]}),/*#__PURE__*/_jsx(\"div\",{className:classes.feed_right_side,children:post.username===user.email.replace(\"@gmail.com\",\"\")&&/*#__PURE__*/_jsx(Post_Delete_Btn,{onDeleteHandler:function onDeleteHandler(){return _onDeleteHandler(id,post);}},Math.random())})]}),/*#__PURE__*/_jsx(Post,{id:id,profileUrl:post.profileUrl,username:post.username,imageUrl:post.photoUrl,caption:post.caption,comments:post.comments,user:user,timestamp:post.timestamp,likes:post.likes},id)]});})});};export default Feed;","map":{"version":3,"sources":["/Users/parth/Desktop/web-dev/social-media-app/src/components/feed/Feed.js"],"names":["React","useContext","useState","useEffect","Fragment","classes","Post_Delete_Btn","UserContext","Post","db","timestamp","storage","Feed","user","posts","setPosts","collection","orderBy","onSnapshot","snapshot","docs","map","doc","id","post","data","onDeleteHandler","imageRef","refFromURL","photoUrl","delete","then","console","log","catch","error","message","feed","feed_container","feed_left_side","profileUrl","feed_img","Math","random","feed_username","username","feed_right_side","email","replace","caption","comments","likes"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, Fragment } from \"react\";\nimport classes from \"./Feed.module.css\";\nimport { Post_Delete_Btn } from \"../../ui/button/Button\";\nimport { UserContext } from \"../../context/userContext\";\nimport Post from \"./post/Post\";\nimport { db, timestamp, storage } from \"../../firebase/firebase\";\n\nconst Feed = () => {\n  const [user] = useContext(UserContext).user;\n  const [posts, setPosts] = useState([]);\n\n  useEffect(() => {\n    db.collection(\"posts\")\n      .orderBy(\"timestamp\", \"desc\")\n      .onSnapshot((snapshot) => {\n        setPosts(\n          snapshot.docs.map((doc) => ({\n            id: doc.id,\n            post: doc.data(),\n          }))\n        );\n      });\n  }, []);\n\n  const onDeleteHandler = (id, post) => {\n    //targeting\n    let imageRef = storage.refFromURL(post.photoUrl);\n\n    //deleting the image\n    imageRef\n      .delete()\n      .then(() => console.log(\"Deleted successfully\"))\n      .catch((error) => console.log(error.message));\n\n    //deleting the post\n    db.collection(\"posts\")\n      .doc(id)\n      .delete()\n      .then(() => console.log(\"Deleted successfully\"))\n      .catch((error) => console.log(error.message));\n  };\n\n  return (\n    <Fragment>\n      {posts.map(({ id, post }) => {\n        return (\n          <div className={classes.feed}>\n            <div className={classes.feed_container}>\n              <div className={classes.feed_left_side}>\n                <img\n                  key={Math.random()}\n                  src={post.profileUrl}\n                  alt=\"profile_pic\"\n                  className={classes.feed_img}\n                />\n                <p key={Math.random()} className={classes.feed_username}>\n                  {post.username}\n                </p>\n              </div>\n              <div className={classes.feed_right_side}>\n                {post.username === user.email.replace(\"@gmail.com\", \"\") && (\n                  <Post_Delete_Btn\n                    key={Math.random()}\n                    onDeleteHandler={() => onDeleteHandler(id, post)}\n                  />\n                )}\n              </div>\n            </div>\n            <Post\n              key={id}\n              id={id}\n              profileUrl={post.profileUrl}\n              username={post.username}\n              imageUrl={post.photoUrl}\n              caption={post.caption}\n              comments={post.comments}\n              user={user}\n              timestamp={post.timestamp}\n              likes={post.likes}\n            />\n          </div>\n        );\n      })}\n    </Fragment>\n  );\n};\n\nexport default Feed;\n"]},"metadata":{},"sourceType":"module"}